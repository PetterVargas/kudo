---
title: CNB-05 - Administraci√≥n y Gesti√≥n de Claves
description: Control de gesti√≥n del ciclo de vida de claves criptogr√°ficas
---

## üéØ Objetivo del Control

Establecer un sistema robusto de gesti√≥n del ciclo de vida completo de claves criptogr√°ficas, desde su generaci√≥n hasta su destrucci√≥n segura.

## üìã Descripci√≥n

Este control define la gesti√≥n de claves:
- Generaci√≥n segura de claves
- Almacenamiento protegido
- Distribuci√≥n controlada
- Rotaci√≥n peri√≥dica
- Auditor√≠a de uso
- Destrucci√≥n segura

## üõ°Ô∏è Controles Requeridos

### Key Management Service (KMS)
Uso obligatorio de servicios gestionados de claves:
- **AWS:** AWS KMS, CloudHSM
- **Azure:** Azure Key Vault
- **GCP:** Cloud KMS
- **Multi-Cloud:** HashiCorp Vault

### Jerarqu√≠a de Claves

**Master Keys (Claves Maestras):**
- Almacenadas en HSM
- Utilizadas para cifrar Data Keys
- Rotaci√≥n anual
- Backup en ubicaci√≥n segura

**Data Keys (Claves de Datos):**
- Generadas por aplicaci√≥n/servicio
- Cifradas con Master Key (envelope encryption)
- Rotaci√≥n trimestral
- Almacenadas junto con datos cifrados

**Key Encryption Keys (KEKs):**
- Capa intermedia de protecci√≥n
- Facilitan rotaci√≥n de Master Keys

### Ciclo de Vida de Claves

1. **Generaci√≥n:**
   - Generador criptogr√°fico robusto (CSPRNG)
   - Longitud adecuada (AES-256, RSA-2048+)
   - Generaci√≥n dentro de HSM cuando sea posible

2. **Almacenamiento:**
   - Nunca en texto plano
   - Cifradas con Key Encryption Key
   - Separaci√≥n por ambiente (dev, prod)
   - Backups cifrados en ubicaci√≥n geogr√°fica distinta

3. **Distribuci√≥n:**
   - Canales seguros (TLS, APIs autenticadas)
   - Just-in-Time distribution
   - Principio de menor privilegio

4. **Uso:**
   - Auditor√≠a de cada operaci√≥n criptogr√°fica
   - Limits de rate para prevenir abuso
   - Separaci√≥n de keys entre ambientes

5. **Rotaci√≥n:**
   - Rotaci√≥n programada:
     - Master keys: anual
     - Data keys: trimestral
     - API keys: mensual
     - Certificados: antes de expiraci√≥n
   - Rotaci√≥n de emergencia ante compromiso

6. **Destrucci√≥n:**
   - Eliminar todas las copias
   - Sobrescribir en storage
   - Documentar destrucci√≥n
   - Mantener re-cifrado de datos con nueva clave

### Separaci√≥n de Keys
- Keys diferentes para cada ambiente (dev, qa, prod)
- Keys diferentes por aplicaci√≥n cr√≠tica
- Keys diferentes por clasificaci√≥n de datos
- Keys de firma vs keys de cifrado

### Control de Acceso a Claves
- RBAC para acceso a KMS
- MFA para operaciones de master keys
- Separaci√≥n de funciones:
  - Key administrator ‚â† Key user
  - Quien crea ‚â† quien autoriza
- Logs de acceso a claves

### Backup y Recuperaci√≥n
- Backup de master keys en HSM secundario
- Procedimiento de recuperaci√≥n documentado
- Testing peri√≥dico de recuperaci√≥n
- Custodia compartida (key ceremony)

### Auditor√≠a y Monitoreo
- Logs de CloudTrail / Azure Monitor
- Alertas de uso an√≥malo de claves
- Reportes de rotaci√≥n de claves
- Revisi√≥n trimestral de permisos

## üìä M√©tricas e Indicadores

- N√∫mero de claves sin rotaci√≥n en per√≠odo definido
- Intentos fallidos de acceso a KMS
- Operaciones criptogr√°ficas por servicio
- Cumplimiento de pol√≠tica de rotaci√≥n
- Keys sin propietario definido

## üîó Herramientas Recomendadas

- **Cloud KMS:** AWS KMS, Azure Key Vault, GCP Cloud KMS
- **Multi-Cloud:** HashiCorp Vault, Thales CipherTrust Manager
- **HSM:** AWS CloudHSM, Azure Dedicated HSM, Thales Luna
- **Secrets Management:** AWS Secrets Manager, Azure Key Vault Secrets
- **Monitoring:** AWS CloudTrail, Azure Monitor, Splunk

## üìö Referencias

- [Inventario y Ciclo de Vida de Llaves](/docs/kudo/politicas/inventario-ciclo-vida-llaves)
- [Gesti√≥n de Certificados Digitales](/docs/kudo/politicas/gestion-certificados-digitales)
- [Mecanismos de Cifrado](/docs/kudo/politicas/mecanismos-cifrado)
- NIST SP 800-57 - Recommendation for Key Management
- ISO 27001:2022 - A.8.24 Cryptography
- FIPS 140-2/140-3 - Security Requirements for Cryptographic Modules

## ‚úÖ Checklist de Implementaci√≥n

- [ ] KMS centralizado implementado
- [ ] Jerarqu√≠a de claves definida (Master/KEK/Data)
- [ ] Pol√≠ticas de rotaci√≥n configuradas y automatizadas
- [ ] HSM para master keys cr√≠ticas
- [ ] Separaci√≥n de claves por ambiente
- [ ] Control de acceso (RBAC) a KMS
- [ ] Auditor√≠a de operaciones criptogr√°ficas
- [ ] Backup de master keys en ubicaci√≥n secundaria
- [ ] Procedimiento de recuperaci√≥n documentado y probado
- [ ] Monitoreo y alertas de uso an√≥malo
